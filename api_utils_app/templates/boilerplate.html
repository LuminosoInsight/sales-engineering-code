{% extends "index.html" %}

{% block content %}

<input name="start" type="submit" value="Start">

<style>
  #data {
    text-align: center;
  }
</style>

<script src="http://code.jquery.com/jquery-latest.js"></script>

<script>
if (typeof String.prototype.startsWith != 'function') {
  // see below for better implementation!
  String.prototype.startsWith = function (str){
    return this.indexOf(str) === 0;
  };
}
</script>

<script>
$(function() {
    //CODE FOR MERGE
    //CODE FOR TERM_UTILS_SEARCH STARTS HERE
    $('input[name=start]').bind('click', function() {
    	var source = new EventSource('/boilerplate_stream');
    	source.onmessage = function(e) {
    		var str = e.data.slice(2)
    		if (str.startsWith("[")) {
    			$("#progress").text(str)
    		}
    		else {
    			$("#data").append(str);
    		}
  		}
	});
    $('input[name=start]').bind('click', function() {
    	console.log("Starting Boilerplate Remover")
      $.getJSON($SCRIPT_ROOT + '/boilerplate_run', {
      }, function(data) {
      	console.log("Finished Boilerplate Remover")
      });
  	});
});

</script>


<script>
if (!!window.EventSource) {
  var source = new EventSource('/');
  source.onmessage = function(e) {
    $("#data").text(e.data);
  }
}
</script>

<div id="progress"></div>

<div id="data"></div>

{% endblock %}